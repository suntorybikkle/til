# EC2

秒単位の従量課金で利用可能な仮想サーバー  
OSを自由に選択可能で、OSより上のレイヤーを自由に利用可能

## 用語説明

- インスタンス
  - サーバー一つというイメージ存在
  - 仮想ネットワーク内に確実に設置されるため、設定しなかった場合デフォルトのVPCに設置される
- AMIイメージ
  - OSセッティング方式を選択すること
  - Linux, Windows, 自作したカスタムAMI, 3rd party製のAMI (有料のものもある)
- インスタンスタイプ
  - CPU、メモリ、ストレージ、ネットワークキャパシティーを様々に組み合わせることが可能
  - t2.nano などの名前で定義される
    - t: ファミリー
	- 2: 世代
	- nano: インスタンスの容量
- リザーブドインスタンス
  - インスタンスを通常借りる場合、オンデマンドとなるが、リザーブドインスタンスは長期契約をすることで、割引される
  - スタンダード
    - 途中で支払いオプションなどが変更不可能だが、割引率が高い (安く買える), マーケットプレイスで売れる
  - コンバーティブル
    - スタンダードよりは割引率が低いが、インスタンスファミリー、OS、テナンシー、支払いオプションの変更可能
- スポットインスタンス
  - AWSが予備で確保していたものを、格安で借りることができるインスタンス
  - 入札式で非常に安いが、AWSの都合によって途中で削除される可能性もある
- 物理対応可能なインスタンス
  - ハードウェア占有インスタンス
    - 同じAWSアカウントのインスタンスとはHWを共有する可能性あり
    - 会社のセキュリティ規定などで、HWを占有する必要があるときとかに有用
  - Dedicated Host
    - 物理サーバーを完全に専用と指定利用できる
  - Bare Metal
    - クラウド上で物理的なサーバーの操作を行うことができる
- ストレージ
  - インスタンスストア
    - EC2に内蔵された物理ストレージ
	- EC2停止時にクリアされる (無料)
  - Elastic Block Store (EBS)
    - 物理的に離れたストレージとEC2をつなげて使う
    - EC2停止時に保存可能で、SnapshotをS3に保存することもできる (有料)
- セキュリティグループ
  - インスタンスへのアクセスに対するファイアウォールを設定する
- キーペア
  - ダウンロードした秘密鍵 (pem) をEC2上の公開鍵と照合する

# EBS

EC2作成時に使うことになるストレージ

- Elastic Block Storeの略称で、ブロックの形式のストレージ
- EC2インスタンスとネットワークで接続されている 99.999%の可用性 (システムが継続して稼働できる能力のこと)
- サイズと利用期間で課金
- AZ内でデフォルトで複数のHWに冗長化済み、セキュルティグループも制御対象外
- データを永続化することもできる
- 他のAZのEBSに接続不可、複数のEC2を利用することはできるが、他EC2インスタンスと共有することはできない、しかし同じAZ内であれば付け替えはできる
- Snapshot 
  - Snapshot を利用してEBSのバックアップができる
  - Snapshotからの復元は別AZにも可能
  - 作成時にブロックレベルで圧縮されるためその容量に対して課金される
  - インスタンス停止時、静止点に作成することを推奨
  - AMIはOS設定のイメージであり、ストレージのバックアップであるSnapshotと異なる
  - AMIを作った際にSnapshotも含まれる
- EBSのボリュームタイプ
  - SSD
    - 汎用SSD
	  - 小~中規模のデータベース
	  - 開発環境
	- プロビジョンドIOPS
	  - 高いI/O性能に依存するNoSQLやアプリ
  - HDD
    - スループット最適化HDD
	  - ビッグデータ処理
	  - DWH
	- コールドHDD
	  - ログデータなどアクセス頻度が低いデータ
  - マグネティック
    - 旧世代のボリュームで基本利用しない
- インスタンスストア
  - EC2に物理的に接続しているストレージ
  - EC2の一時的なデータがほじされ、EC2の停止・終了とともにクリア
